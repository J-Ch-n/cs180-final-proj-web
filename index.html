<!-- Referenced https://www.youtube.com/watch?v=i7uJAOFEd4g -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>CS180 Final Project</title>
        <link rel="stylesheet" href="https://cdn.lineicons.com/4.0/lineicons.css" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <link rel="stylesheet" href="style.css">
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </head>

    <body>
        <div class="wrapper">
            <div id="sidebar"> 
                <div class="sidebar-logo">
                    <a href="#title">Navigation</a>
                </div>
                <ul class="sidebar-nav">
                    <li class="sidebar-nav-item"> 
                        <button type="button" class="btn btn-light">
                            <a href="#part1">
                                <span>Part 1</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part2">
                                <span>Part 2</span>
                            </a>
                        </button>
                    </li>
                    <li class="sidebar-nav-item">
                        <button type="button" class="btn btn-light">
                            <a href="#part3">
                                <span>BW</span>
                            </a>
                        </button>
                    </li>
                </ul>
            </div>
            <!-- End of sidebar -->
             
            <div class="main">
                <h1 id="title"> CS180 Project 5 </h1>
                <h2 id="part1"> Part 1: Fit a Neural Field to a 2D Image </h2>

                <div class="text-container"> 
                    <h3>Model Architecture</h3>

                    <p> I constructed a small MLP model with four linear layers, three ReLU activations, and one Sigmoid activation. Before I pass the 2D coordinates 
                        of the image into the model, I used a sinonoidal positional encoding to encode the 2D coordinates at each dimension. The encoding dimension is L.
                        The model architecture is shown below.
                    </p>

                    <div class="single_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data/p1/part1_model_arch.png", width="400">
                                <figcaption class="caption"> 
                                    Model Architecture
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <h4>Hyperparameters</h4>
                    <ul>
                        <li> PE dimension: L = 32 </li>
                        <li> Hidden dimension: D = 256 </li>
                        <li> Adam Optimizer lr = 0.001 </li>
                        <li> Number of iterations: 1000 </li>   
                    </ul>
                    
                    <h4>Training PSNR</h4>

                    <p> I calculated the PSNR using this equation:
                        \[
                        PSNR = 10 \cdot log_{10}\left(\frac{1}{MSE}\right)
                        \]
                        The training PSNR for this model on the test fox image is as follows.
                    </p>
                    
                    <div class="single_col"> 
                        <div class=image>
                            <figure> 
                                <img src="data/p1/regular_fox_psnr.png", width="400">
                                <figcaption class="caption"> 
                                    Fox Image Training PSNR
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <h3>Visualization</h3>

                    <p>
                        Here are the training process visualization of the test fox image. The training process progressively delivers better images of a fox.
                    </p>
                    
                    <div class="three_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_fox_2d_1.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 1
                                    
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_fox_2d_20.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 20
                                    
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_fox_2d_100.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 100
                                    
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_fox_2d_300.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 300
                                    
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_fox_2d_500.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 500
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_fox_2d_999.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 999
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <h3> Hyperparameter Tuning </h3>

                    <p> 
                        Here I two different parameters to see how tuning each parameter affects the model output.
                    </p>

                    <ul>
                        <li> 
                            I changed the hidden dimension from 256 to 50. The resulting fox image is not very different despite a 
                            significantly different model structure. The only difference is that the output is slightly less detailed
                            thant the original model's output. This implies that a 2D coordinates system may not have too much complexity. 
                            Even a simple network can still learn it very well.
                        </li>
                        <li> 
                            I then changed the encoding dimension L from 10 to 4. The resulting fox image is significantly more cartoonish than the
                            original model's output. This is probably because the reduction of encoding dimension results in a negligible effect of 
                            the positional encoding, causing the image to have less resolution.
                        </li>
                    </ul>

                    <p> Here are the results. </p>

                    <div class="three_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/hidden_50_fox_2d_1.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 1
                                    <br/>
                                    Fox: H = 50
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/hidden_50_fox_2d_20.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 20
                                    <br/>
                                    Fox: H = 50
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/hidden_50_fox_2d_100.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 100
                                    <br/>
                                    Fox: H = 50
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/hidden_50_fox_2d_300.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 300
                                    <br/>
                                    Fox: H = 50
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/hidden_50_fox_2d_500.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 500
                                    <br/>
                                    Fox: H = 50
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/hidden_50_fox_2d_999.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 999
                                    <br/>
                                    Fox: H = 50
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <div class="single_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/hidden_50_fox_psnr.png" width="400">
                                <figcaption class="caption"> 
                                    PSNR Plot
                                    <br/>
                                    Fox: H = 50
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    

                    <div class="three_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_4_fox_2d_1.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 1
                                    <br/>
                                    Fox: L = 4
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_4_fox_2d_20.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 20
                                    <br/>
                                    Fox: L = 4
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_4_fox_2d_100.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 100
                                    <br/>
                                    Fox: L = 4
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_4_fox_2d_300.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 300
                                    <br/>
                                    Fox: L = 4
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_4_fox_2d_500.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 500
                                    <br/>
                                    Fox: L = 4
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_4_fox_2d_999.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 999
                                    <br/>
                                    Fox: L = 4
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="single_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_4_fox_psnr.png" width="400">
                                <figcaption class="caption"> 
                                    PSNR Plot
                                    <br/>
                                    Fox: L = 4
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <h3>Another Image: UC Berkeley</h3>

                    <p> 
                        Here I tried my original model on an image of UC Berkeley. The hyperparameters are the same as the original model.
                    </p>
                    
                    <ul>
                        <li> PE dimension: L = 32 </li>
                        <li> Hidden dimension: D = 256 </li>
                        <li> Adam Optimizer lr = 0.001 </li>
                        <li> Number of iterations: 1000 </li>   
                    </ul>

                    <p> 
                        I visualized the intermediate steps for the training process and plotted the PSNR for the entire process. Here are the results.
                    </p>

                    <div class="three_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_cal_2d_1.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 1
                                    <br/>
                                    UCB Original Model
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_cal_2d_20.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 20
                                    <br/>
                                    UCB Original Model
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_cal_2d_100.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 100
                                    <br/>
                                    UCB Original Model
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_cal_2d_300.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 300
                                    <br/>
                                    UCB Original Model
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_cal_2d_500.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 500
                                    <br/>
                                    UCB Original Model
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_cal_2d_999.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 999
                                    <br/>
                                    UCB Original Model
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <div class="single_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/regular_cal_psnr.png" width="400">
                                <figcaption class="caption"> 
                                    PSNR Plot
                                    <br/>
                                    UCB Original Model
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <p> I have also done some hyperparameter tuning for the Berkeley image. </p>

                    <ul>
                        <li> 
                            I changed the hidden dimension from 256 to 20. Despite the simplicity of the 2D model, a hidden dimension of 20 is not enough 
                            for the model to learn the image. Thus, the result has a lot of a grid-like artifacts and the image is very blury.
                        </li>
                        <li> 
                            I then changed the encoding dimension L from 10 to 3. Similar to the fox image, the resulting image is significantly more cartoonish than the
                            original model's output. This is probably because the reduction of encoding dimension results in a negligible effect of 
                            the positional encoding, causing the image to have less resolution.
                        </li>
                    </ul>

                    <p> Here are the results. </p>

                    <div class="three_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/layer_20_cal_2d_1.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 1
                                    <br/>
                                    UCB H = 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/layer_20_cal_2d_20.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 20
                                    <br/>
                                    UCB H = 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/layer_20_cal_2d_100.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 100
                                    <br/>
                                    UCB H = 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/layer_20_cal_2d_300.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 300
                                    <br/>
                                    UCB H = 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/layer_20_cal_2d_500.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 500
                                    <br/>
                                    UCB H = 20
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/layer_20_cal_2d_999.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 999
                                    <br/>
                                    UCB H = 20
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <div class="single_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/layer_20_cal_psnr.png" width="400">
                                <figcaption class="caption"> 
                                    PSNR Plot
                                    <br/>
                                    UCB H = 20
                                </figcaption>
                            </figure>
                        </div>
                    </div>

                    <div class="three_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_3_cal_2d_1.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 1
                                    <br/>
                                    Cal L = 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_3_cal_2d_20.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 20
                                    <br/>
                                    Cal L = 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_3_cal_2d_100.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 100
                                    <br/>
                                    Cal L = 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_3_cal_2d_300.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 300
                                    <br/>
                                    Cal L = 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_3_cal_2d_500.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 500
                                    <br/>
                                    Cal L = 3
                                </figcaption>
                            </figure>
                        </div>
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_3_cal_2d_999.png" width="200">
                                <figcaption class="caption"> 
                                    Iteration: 999
                                    <br/>
                                    Cal L = 3
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                    
                    <div class="single_col">
                        <div class="image">
                            <figure> 
                                <img src="data/p1/L_3_cal_psnr.png" width="400">
                                <figcaption class="caption"> 
                                    PSNR Plot
                                    <br/>
                                    Cal L = 3
                                </figcaption>
                            </figure>
                        </div>
                    </div>
                </div>

                <h2 id="part2"> Part 2: Fit a Neural Radiance Field from Multi-view Images </h2>

                <div class="text-container"> 
                    <h3> Part 2.1: Create Rays from Cameras </h3>
                    <h4> Camera to World Coordinate Conversion</h4>
                    <p> 
                        To transform the given camera coordinates into the world coordinates, I used the left multiplication of
                        the camera-to-world matrix on the homogeneous camera coordinates to recover the world coordinate. The c2w 
                        matrix is given in the dataset. The output world coordinates are homoegneous, so we need to remove the appended
                        1 to recover the true 3D coordinates.
                    </p>

                    <h4> Pixel to Camera Coordinate Conversion</h4>
                    <p> 
                        To transform the pixel coordinates into the camera coordinates, I first constructed the K matrix using the given focal length (same for fx and fy).
                        Then, I chose a depth of s = 1 as the multiplier to the pixel coordinates. Finally, I took the inverse of the K matrix and multiplied it on the left of the
                        pixel coordinates to recover the camera coordinates. Note that the resulting camera coordinates are not homogeneous, while the input pixel coordinates are.
                    </p>

                    <p> 
                        I implemented the batched version for both of the functions.
                    </p>

                    <h4> Pixel to Ray </h4>

                    <p> 
                        To convert pixels to rays, we need to first transform the pixel coordinates into world coordinates using the above functions in tandem.
                        Then, we need to recover the origin of the rays (the location of the cameras [ox, oy] in the K matrix), and the direction of the rays (the normalized vector between the ray origin and the point of observation in world coordinate.)
                        Note that the torch.norm function behaves differently from np.linalg.norm, so we need to make adjustments accordingly for direction normalization.
                        I implemted a batched version for this function as well.
                    </p>
                </div>

                <h3> Part 2.2: Sampling Rays </h3>

                <h4> Sampling Rays from Images </h4>

                <p> 
                    To sample rays from the images, I used two approaches. 
                </p>

                <ul>
                    <li>
                        The first approach is to sample M random images with replacement and then sample N // M pixels from each chosen image.
                    </li>
                    <li>
                        The second approach is to sample N random pixels from a linearized pixel matrix that consists of all coordinates from the given images.
                    </li>
                </ul>

                <p>
                    For both approaches, I used the chosen coordinates as the input for the functions from the previous parts to generate rays_d and rays_o, the directions and origin of the rays.
                    To reduce the training overhead, I precomputed all possible rays and only sampled the cached rays during training.
                </p>

                <h3> Part 2.3: Putting the Dataloading All Together</h3>

                <p> After putting everything into a class called RaysData, I then visualized the sampling process using the provided code. </p>
                
                <div class="single_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/sphere_sample.png" width="400">
                            <figcaption class="caption"> 
                                All Cameras Visualization
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/one_sample.png" width="400">
                            <figcaption class="caption"> 
                                One Camera Visualization
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/one_right_top.png" width="400">
                            <figcaption class="caption"> 
                                One Camera Top Right Visualization
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <h3> Part 2.4: Neural Radiance Field </h3>

                <p>
                    In this part, I constructed a MLP model for 3D Neural Radiance Field, which extends the model from part 1. 
                    There are two inputs to the model, one is the 3D world coordinates of the obersvation points, and two is the 3D ray directions.
                    I used sinosoidal positional encoding to encode both inputs and fed them into the network. To prevent the network from forgetting the
                    initial input, I used a skip connection using torch.cat. The output of the network is a 3D RGB color coordinate and a 1D density value.
                    Here is the detailed network structure.
                </p>

                <div class="single_col">
                    <div class="image">
                        <figure> 
                            <img src="mlp_nerf.png" width="400">
                            <figcaption class="caption"> 
                                Model Architecture
                            </figcaption>
                        </figure>
                    </div>
                </div>
                
                <h3> Part 2.5: Volume Rendering </h3>

                <p> 
                    In this part, I implemented the volumetric rendering function to get render the predicted image from the model outputs. I followed the
                    following equation using torch.cumsum for vectorizating.

                    \[
                    \begin{align}
                    \hat{C}(\mathbf{r})=\sum_{i=1}^N T_i\left(1-\exp \left(-\sigma_i \delta_i\right)\right) \mathbf{c}_i, \text { where } T_i=\exp
                    \left(-\sum_{j=1}^{i-1} \sigma_j \delta_j\right) \end{align}
                    \]
                </p>

                <p> 
                    I then trained the model using the following hyperparameters.
                </p>

                <ul>
                    <li>
                        Ray_d PE dimension: L = 4
                    </li>
                    <li>
                        3D coordinate PE dimension: L = 15
                    </li>
                    <li>
                        Adam Optimizer lr = 0.0005
                    </li>
                    <li>
                        Number of iterations: 6000
                    </li>
                </ul>

                <h4> Validation Results </h4>

                <div class="three_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_0.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 0
                                <br/>
                                Lego Validation 1 
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_100.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 100
                                <br/>
                                Lego Validation 1 
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_200.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 200
                                <br/>
                                Lego Validation 1 
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_800.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 800
                                <br/>
                                Lego Validation 1 
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_1000.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 1000
                                <br/>
                                Lego Validation 1 
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_5900.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 5900
                                <br/>
                                Lego Validation 1 
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <div class="three_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_0.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 0
                                <br/>
                                Lego Validation 2
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_100.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 100
                                <br/>
                                Lego Validation 2
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_200.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 200
                                <br/>
                                Lego Validation 2
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_800.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 800
                                <br/>
                                Lego Validation 2
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_1000.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 1000
                                <br/>
                                Lego Validation 2
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_2_5900.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 5900
                                <br/>
                                Lego Validation 2
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <div class="three_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_3_0.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 0
                                <br/>
                                Lego Validation 3
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_3_100.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 100
                                <br/>
                                Lego Validation 3
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_3_200.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 200
                                <br/>
                                Lego Validation 3
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_3_800.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 800
                                <br/>
                                Lego Validation 3
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_3_1000.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 1000
                                <br/>
                                Lego Validation 3
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_3_5900.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 5900
                                <br/>
                                Lego Validation 3
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <div class="three_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_4_0.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 0
                                <br/>
                                Lego Validation 4
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_4_100.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 100
                                <br/>
                                Lego Validation 4
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_4_200.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 200
                                <br/>
                                Lego Validation 4
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_4_800.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 800
                                <br/>
                                Lego Validation 4
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_4_1000.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 1000
                                <br/>
                                Lego Validation 4
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_4_5900.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 5900
                                <br/>
                                Lego Validation 4
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <div class="three_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_5_0.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 0
                                <br/>
                                Lego Validation 5
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_5_100.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 100
                                <br/>
                                Lego Validation 5
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_5_200.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 200
                                <br/>
                                Lego Validation 5
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_5_800.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 800
                                <br/>
                                Lego Validation 5
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_5_1000.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 1000
                                <br/>
                                Lego Validation 5
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_5_5900.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 5900
                                <br/>
                                Lego Validation 5
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <div class="three_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_6_0.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 0
                                <br/>
                                Lego Validation 6
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_6_100.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 100
                                <br/>
                                Lego Validation 6
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_6_200.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 200
                                <br/>
                                Lego Validation 6
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_6_800.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 800
                                <br/>
                                Lego Validation 6
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_6_1000.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 1000
                                <br/>
                                Lego Validation 6
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/val_lego_6_5900.png" width="200">
                            <figcaption class="caption"> 
                                Iteration: 5900
                                <br/>
                                Lego Validation 6
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <h4> Validation PSNR Curves </h4>
                <div class="three_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/Lego_0_second_psnr.png" width="300">
                            <figcaption class="caption"> 
                                Validation 1
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/Lego_10_second_psnr.png" width="300">
                            <figcaption class="caption"> 
                                Validation 2
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/Lego_20_second_psnr.png" width="300">
                            <figcaption class="caption"> 
                                Validation 3
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/Lego_30_second_psnr.png" width="300">
                            <figcaption class="caption"> 
                                Validation 4
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/Lego_40_second_psnr.png" width="300">
                            <figcaption class="caption"> 
                                Validation 5
                            </figcaption>
                        </figure>
                    </div>
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/Lego_50_second_psnr.png" width="300">
                            <figcaption class="caption"> 
                                Validation 6
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <div class="single_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/combined_validation_psnr.png" width="300">
                            <figcaption class="caption"> 
                                Combined Validation
                            </figcaption>
                        </figure>
                    </div>
                </div>

                <h4> Resulting GIF </h4>

                <p> After training, I used the model to predict images on new views, and then used them to generate a 360 view of the lego.</p>

                <div class="single_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/lego_looping.gif" width="300">
                            <figcaption class="caption"> 
                                Lego Loop 
                            </figcaption>
                        </figure>
                    </div>
                </div>
                <h2 id="part3"> Part 3: Bells and Whistles </h2>

                <p> 
                    I changed the background color of the lego scene during the rendering process. The background color is the color that is not blocked by the 
                    lego, so I just needed to add the desired color scaled by the transmittance that is not blocked by the lego. Namely, I just need to add a layer of color
                    that terminates at the bottom of the ray.
                </p>

                <p> Here is the result. </p>

                <div class="single_col">
                    <div class="image">
                        <figure> 
                            <img src="data/p2/NeRF/lego_bw.gif" width="300">
                            <figcaption class="caption"> 
                                Changed Background.
                            </figcaption>
                        </figure>
                    </div>
                </div>

                
                

            </div>
            
        </div>
        
    </body>
</html>
